import streamlit as st
import pandas as pd

# --- CONFIGURACIÃ“N DE LA PÃGINA ---
st.set_page_config(page_title="Mudanza Prime App", page_icon="ğŸšš", layout="centered")

# --- TÃTULO Y ENCABEZADO ---
st.title("ğŸšš Cotizador Mudanza Prime")
st.write("Calcula tu mudanza ideal seleccionando los recursos necesarios.")

# --- BARRA LATERAL (INPUTS DEL USUARIO) ---
st.sidebar.header("1. Detalles del Servicio")

# SelecciÃ³n de CamiÃ³n
tipo_camion = st.sidebar.selectbox(
    "Selecciona el tamaÃ±o del camiÃ³n:",
    ("PequeÃ±o (1-2 Hab)", "Mediano (3-4 Hab)", "Grande (Casa Completa)")
)

# Definir precios base y capacidad segÃºn camiÃ³n
if tipo_camion == "PequeÃ±o (1-2 Hab)":
    precio_base = 80
    capacidad_max_m3 = 15
    imagen_camion = "ğŸš›"
elif tipo_camion == "Mediano (3-4 Hab)":
    precio_base = 150
    capacidad_max_m3 = 30
    imagen_camion = "ğŸš›ğŸš›"
else:
    precio_base = 250
    capacidad_max_m3 = 60
    imagen_camion = "ğŸš›ğŸš›ğŸš›"

# Inputs numÃ©ricos
distancia = st.sidebar.number_input("Distancia aproximada (km):", min_value=1, value=10)
personal = st.sidebar.slider("Cantidad de Personal (Cargadores):", 1, 6, 2)
pisos = st.sidebar.radio("Â¿Hay ascensor?", ["SÃ­", "No (Escaleras)"])

st.sidebar.header("2. Materiales de Embalaje")
cajas = st.sidebar.number_input("Cantidad de Cajas (Cartones):", min_value=0, value=10)
rollos = st.sidebar.number_input("Rollos de plÃ¡stico/burbuja:", min_value=0, value=2)

# --- CÃLCULOS LÃ“GICOS (BACKEND) ---
costo_km = 1.5  # Precio por kilÃ³metro
costo_personal = 25  # Precio por persona
costo_caja = 2.50
costo_rollo = 5.00
recargo_escaleras = 20 if pisos == "No (Escaleras)" else 0

# CÃ¡lculo total
total_materiales = (cajas * costo_caja) + (rollos * costo_rollo)
total_servicio = precio_base + (distancia * costo_km) + (personal * costo_personal) + recargo_escaleras
total_final = total_servicio + total_materiales

# EstimaciÃ³n de volumen (SimulaciÃ³n de lÃ³gica)
volumen_estimado = (cajas * 0.1) + (personal * 2) # LÃ³gica simple para el ejemplo
porcentaje_ocupacion = min(volumen_estimado / capacidad_max_m3, 1.0)

# --- VISUALIZACIÃ“N DE RESULTADOS (FRONTEND) ---
st.divider()

col1, col2 = st.columns(2)

with col1:
    st.subheader("Resumen Visual")
    st.write(f"**CamiÃ³n seleccionado:** {tipo_camion}")
    st.write(f"**Icono:** {imagen_camion}")
    
    # Barra de OcupaciÃ³n del CamiÃ³n (Mejora Visual)
    st.write("ğŸ“¦ **OcupaciÃ³n estimada del camiÃ³n:**")
    st.progress(porcentaje_ocupacion)
    if porcentaje_ocupacion > 0.9:
        st.warning("âš ï¸ Â¡Cuidado! El camiÃ³n estÃ¡ casi lleno. Considera uno mÃ¡s grande.")
    else:
        st.success("âœ… Espacio suficiente.")

with col2:
    st.subheader("CotizaciÃ³n Final")
    st.metric(label="Total Estimado", value=f"${total_final:.2f}")
    
    # Desglose rÃ¡pido
    st.write("---")
    st.caption(f"Transporte base: ${precio_base}")
    st.caption(f"Materiales: ${total_materiales}")
    st.caption(f"Personal ({personal}): ${personal * costo_personal}")

# --- BOTÃ“N DE ACCIÃ“N ---
if st.button("ğŸ“… Reservar esta Mudanza"):
    st.balloons()
    st.success(f"Â¡CotizaciÃ³n de ${total_final:.2f} enviada! Un asesor te contactarÃ¡.")